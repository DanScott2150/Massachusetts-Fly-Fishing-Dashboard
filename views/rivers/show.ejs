<% include ../partials/header %>

<!-- style for displaying/hiding section info panels -->
<!-- eventually move into main.css, but here now just for ease of testing -->
<style>
    .hidden{    
    display: none;
    }
    
    #sidebar-sticky{
        /*height: 25vh;*/
        position: sticky;
        top: 5%;
    }
</style>

<div class="container">
    <div class="row">
        <div class="col-md-3" id="sidebar-sticky">
            <p class="lead">River Dashboard</p>
            <div class="list-group">
                <nav>
                <ul id="river-menu">
                    <li class="list-group-item active"><%=river.name%></li>
                    
                    <li class="list-group-item"><a href="#weather">Weather</a></li>
                    <li class="list-group-item"><a href="#usgs">Flow Rates</a></li>
                    <li class="list-group-item"><a href="#stocking">Stocking Report</a></li>
                    <li class="list-group-item"><a href="#outings">Past Outings</a></li>
                    <li class="list-group-item"><a href="#map">Map</a></li>

                    
                    <!-- Print out an LI for each river section -->
                    <!-- user can then click to toggle a display planel for that section -->
                    
                    <% //river.sections.forEach(function(section){ %>
                        <!--<li class="list-group-item" id="<%=//section.name%>">-->
                            <%= //section.name %>
                        <!--</li>-->
                    <% //}); %>
                    
                </ul>
                </nav>
            </div> <!-- list-group -->
        </div>
        
        <div class="col-md-9">
            <div class="thumbnail">
                <div class="caption-full">
                    <h4><%= river.name %></h4>
                    <h5><%= river.location %></h5>
                    <!--<p><%= river.description %></p>-->

                </div>
            </div>
            
<!-- Weather -->
<section id="weather">
            <div class="thumbnail"  id="weather">
                <a name="#weather"></a>
                <div class="container-fluid">
                    <div class="row">
                        <% include ../partials/weather %>    
                    </div>
                </div>
            </div>
</section>
<!-- end Weather -->

<!-- USGS river flow data -->            
<section id="usgs">
            <div class="thumbnail" id="usgs">
                <a name="#usgs"></a>
                <style>
                    .thumbnail img{
                        width: 576px;
                    }
                </style>
                <p>USGS Data Location: <%= usgsData.value.timeSeries[0].sourceInfo.siteName %> | River ID: <%= river.usgsID %></p>
                <p>Current Flow: <%= usgsData.value.timeSeries[0].values[0].value[0].value %></p>
                <img src="http://waterdata.usgs.gov/nwisweb/graph?site_no=<%=river.usgsID%>&parm_cd=00060"  width="288" height="200" alt="USGS Water-data graph for site 06025500"  /> 
            </div>
</section>
<!-- end of USGS -->


<!-- Trout Stocking -->
<section id="stocking">
            <div class="thumbnail"  id="stocking">
                <a name="#stocking"></a>
                <div class="container-fluid">
                    <div class="row">
                        <% include ../partials/stocking %> 
                    </div>
                </div>
            </div>
</section>
<!-- END trout stocking -->
                
            
<!--
            <div class="thumbnail" id="map">
                Map Div
            </div>
-->

            <div class="thumbnail">

        <!-- Section info panel -->
        <!-- Important: all toggle-panels have to have an ID prefix of 'section-' -->
                
                <!-- default section, hides once an actual section is selected -->
<!--                <div id="section-default">Select a River Section to view more info</div>    -->
                
                <!-- Cycle through each river section and print out a div -->
                <% //river.sections.forEach(function(section){ %>     
<!--                    <div class="river-section hidden" id="section-<%= //section.name %>"> -->
<!--                    <h2><%= //section.name %></h2>    -->
<!--                    </div>    -->          
<!--                <% //}); %>   -->
            
            </div>


<section id="outings">
            <div class="well">
                <a name="#outings"></a>
                <h4>Past Outings</h4>
                        <p>Coming soon: Past outings/journal</p>
                        <p>Planned feature, user can</p>
                        <ul>
                            <li>Add, edit, delete entries that detail past outings on this river. Dates, section(s) fished, fishes caught, flies used, notes & observations, etc.</li>
                        </ul>
                <% //river.comments.forEach(function(comment){ %>
                    <p><strong><%= //comment.author %></strong> - <%=//comment.text %></p>
                
                <% //}) %>
            </div>
</section>
            
            
            <!-- Map -->
            <style>
                #map{
                    height: 400px;
                }
            </style>
<section id="map">
            <div class="thumbnail"  id="map">
                <a name="#map"></a>
                <div class="container-fluid">
                    <div class="row">
                        <h4>Map</h4>
                        <p>Coming soon: Map view</p>
                        <p>Planned feature, user can customize map to:</p>
                        <ul>
                            <li>Mark specific fishing holes (i.e. Swift y-pool/cadylane/etc; Millers wendelldepot/bearsden/etc</li>
                            <li>Mark parking/access spots?</li>
                            <li>Mark trout stocking points? (think specific location data available somewhere via Mass DFW data)</li>
                            <li>Mark nearby camping options?</li>
                        </ul>
                    </div>
                </div>
            </div>
</section>
<!-- END map -->
            

            <div class="well">
                <a class="btn btn-warning" href="/rivers/<%= river._id %>/edit">Edit</a>
                <form class="delete-form" action="/rivers/<%= river._id%>?_method=DELETE" method="POST">
                    <button class="btn btn-danger">Delete</button>
                </form>
            </div>
            

            </div>
        </div>
    </div>


<script>
//JQUERY functionality that allows user to select & view info for a given section
//Current problem: only works if section's 'name' property contains no spaces
    $("#river-sections li").on("click", function(e){

        $this = $(this);
        $id = $this.attr('id');
        $class = '.' + $('#section-' + $id).attr('class').replace('hide', '');

        $('div[id^=section]').not($class).addClass('hidden');
        $('#section-' + $id).removeClass('hidden');
    });
</script>

<!--<script src="/js/darksky.js"></script>-->

<% include ../partials/footer %>
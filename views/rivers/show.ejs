<% include ../partials/header %>

<div class="container">
    <div class="row">
        <div class="col-md-3" id="sidebar-sticky">
            <p class="lead">River Dashboard</p>
            <div class="list-group" id="river-menu">
               
                    <nav>
                <ul class="nav" role="tablist">
                    <li class="list-group-item active"><%=river.name%></li>
                    
                    <li class="list-group-item"><a href="#weather">Weather</a></li>
                    <li class="list-group-item"><a href="#usgs">Flow Rates</a></li>
                    <li class="list-group-item"><a href="#stocking">Stocking Report</a></li>
                    <li class="list-group-item"><a href="#outings">Past Outings</a></li>
                    <li class="list-group-item"><a href="#map">Map</a></li>
                    
                </ul>
                </nav>
            </div> <!-- list-group -->
        </div>
        
        <div class="col-md-9">
            <div class="thumbnail">
                <div class="caption-full">
                    <h4><%= river.name %></h4>
                    <h5><%= river.location %></h5>

                </div>
            </div>
            
<!-- Weather -->
<!--<section id="weather" class="section">-->
            <div class="thumbnail"  id="weather">
                <div class="container-fluid">
                    <div class="row">
                        <% include ../partials/weather %>    
                    </div>
                </div>
            </div>
<!--</section>-->
<!-- end Weather -->

<!-- USGS river flow data -->            
<!--<section id="usgs" class="section">-->
            <div class="thumbnail" id="usgs">
                <style>
                    .thumbnail img{
                        width: 576px;
                    }
                </style>
                <p>USGS Data Location: <%= usgsData.value.timeSeries[0].sourceInfo.siteName %> | River ID: <%= river.usgsID %></p>
                <p>Current Flow: <%= usgsData.value.timeSeries[0].values[0].value[0].value %></p>
                <img src="http://waterdata.usgs.gov/nwisweb/graph?site_no=<%=river.usgsID%>&parm_cd=00060"  width="288" height="200" alt="USGS Water-data graph for site 06025500"  /> 
            </div>
<!--</section>-->
<!-- end of USGS -->

<!-- Trout Stocking -->
<section id="stocking" class="section">
            <div class="thumbnail"  id="stocking">
                <div class="container-fluid">
                    <div class="row">
                        <% include ../partials/stocking %> 
                    </div>
                </div>
            </div>
</section>
<!-- END trout stocking -->
                

<section>
    <div class="well section" id="outings">
        <h4>Trip Journal</h4>
        
        <p>
            <a class="btn btn-success" href="/rivers/<%=river._id%>/journals/new">
                Add New Journal Entry
            </a>
        </p>
    
        <% river.journals.forEach(function(journal){ %>
    
            <p>
                <strong><%= journal.date.toLocaleString('en-us', { timeZone: 'UTC', weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) %></strong> : 
                <%= journal.text %>
            </p>
        <% }) %>
    </div>
</section>
            
        
            
<div id='map' style='width: 100%; height: 500px;'></div>

<script>
    //pass river lat/lng from server-side to client-side
    var mapCenter = [<%=river.lng%>, <%=river.lat%>];
</script>

<script type="text/javascript" src="../js/mapbox-show.js"></script>
            
            <div class="thumbnail">
                <div class="container-fluid">
                    <div class="row">
                        <h4>Map</h4>
                        <p>Coming soon: Map view</p>
                        <p>Planned feature, user can customize map to:</p>
                        <ul>
                            <li>Mark specific fishing holes (i.e. Swift y-pool/cadylane/etc; Millers wendelldepot/bearsden/etc</li>
                            <li>Mark parking/access spots?</li>
                            <li>Mark trout stocking points? (think specific location data available somewhere via Mass DFW data)</li>
                            <li>Mark nearby camping options?</li>
                        </ul>
                    </div>
                </div>
            </div>
<!-- END map -->
            

            <div class="well">
                <a class="btn btn-warning" href="/rivers/<%= river._id %>/edit">Edit</a>
                <form class="delete-form" action="/rivers/<%= river._id%>?_method=DELETE" method="POST">
                    <button class="btn btn-danger">Delete</button>
                </form>
            </div>
            
            

            </div>
        </div>
    </div>

<% include ../partials/footer %>